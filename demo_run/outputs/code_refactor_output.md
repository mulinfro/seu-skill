## 重构前问题
1. 错误分支中多处重复 `print(..., file=sys.stderr); return 2`。
2. 错误输出风格虽一致，但维护成本偏高，后续扩展容易漏改。

## 重构动作
- [抽取] 新增 `fail(message)` 统一错误输出与返回码。
- [优化] 将 3 个错误分支改为 `return fail(...)`。

## 重构后收益
- 可读性: 错误路径更短，主流程更聚焦。
- 可维护性: 修改错误策略只需改 1 处。
- 性能/交互: 行为不变，错误提示一致性提升。

## 风险与验证
- 风险: 低；仅重构公共错误处理函数。
- 验证: `python -m unittest discover -s demo_run/tests -v` 5/5 通过。
